{% extends 'base.html' %}
{% block title %}{{ post.title }}{% endblock %}
{% block content %}
<div class="post-detail">
    <h1 class="post-title">{{ post.title }}</h1>
    <p class="post-meta">
        Posted by <strong>{{ post.author.username }}</strong>
        on {{ post.posted_at.strftime('%B %d, %Y at %H:%M') }}
    </p>
    <div class="post-content">
        {{ post.content|safe }}
    </div>
    <hr>

    {% if current_user.is_authenticated %}
    {% if current_user.is_main_admin %}
    <a href="{{ url_for('post.edit_post', post_id=post.id) }}" class="btn btn-sm btn-warning">Edit</a>
    <form action="{{ url_for('post.delete_post', post_id=post.id) }}" method="POST"
        onsubmit="return confirm('Are you sure you want to delete this post?');" style="display:inline;">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <button type="submit" class="btn btn-sm btn-danger">Delete</button>
    </form>
    {% elif current_user.is_club_manager and post.author_id == current_user.id %}
    <a href="{{ url_for('post.edit_post', post_id=post.id) }}" class="btn btn-sm btn-warning">Edit</a>
    <form action="{{ url_for('post.delete_post', post_id=post.id) }}" method="POST"
        onsubmit="return confirm('Are you sure you want to delete this post?');" style="display:inline;">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <button type="submit" class="btn btn-sm btn-danger">Delete</button>
    </form>
    {% endif %}
    {% endif %}

    <a href="{{ url_for('post.posts') }}" class="btn btn-secondary">Back to All Posts</a>
</div>
{% endblock %}